/* DEPENDENCIES NEEDED:
*	- onDomReady.js 1.2 (c) 2012 Tubal Martin - MIT license 
*	- 140 medley (c) 2011 - Honza Pokorny Licensed under the terms of the BSD license
*	- Vine : An events library that supports binding, unbinding, and triggering events on DOM elements or JavaScript Objects
*	- W, width management tool for responsive designs
*	- Tween functions: linearTween, easeInQuad, easeOutQuad, easeInOutQuad, easeInCubic, easeOutCubic, easeInOutCubic, easeInQuart, easeOutQuart, easeInOutQuart, easeInQuint, easeOutQuint, easeInSine, easeOutSine, easeInOutSine, easeInExpo, easeOutExpo, easeInCirc, easeOutCirc, easeInOutCirc
*	- c.sa.utils.js
*
*/


 /*
 * Simple Animation :
 * (c) 2013 - Ben Priddy
 *	FILE LIST: 
 *	- c._sa.js
 *	- c.sa.element.js
 *	- c.sa.sprite.js
 *	- c.sa.image_seq.js
 *	- c.sa.scroll.js
 *	- c.sa.timer.js
 *	- c.sa.touchmove.js
 *
 *	TO DO:
 *		make compile process for these classes..  make so only necessary extended class are included.. e.g. c.sa.scroll.js and c.sa.touchmove.js
 */
;var simpleAnimation=function(e,t){var n=this;var r=1e3;var s=0;var o="test";var u=false;e=e?e:{};var a=function(e,t){var r={element:null,totalSteps:1e4,firstStep:0,animationResolution:10,autoEnable:false,animateCompleteCallback:function(){}};n.options=mergeObjects(r,e);if(t){n.options.animateCompleteCallback=t}n.options.instructions=o};var f=function(){if(!u){window.requestAnimationFrame(n.processStep);u=true}};var l=function(e,t){switch(e.model().type){case"sprite":var r=Math.round((e.model().frames-e.model().startframe)*t)+e.model().startframe;log("sprite setValues ",r);e.goToFrame(r);break;case"css":var i=$$(e.model().element);for(var s in e.model().startValues){var o;switch(t){case 0:o=e.model().startValues[s];break;case 1:o=e.model().endValues[s];break;default:if(e.model().easing!="none"){var u=e.model().endValues[s]-e.model().startValues[s];var a=Math[e.model().easing](t,e.model().startValues[s],u,1)}else{var a=(e.model().endValues[s]-e.model().startValues[s])*t+e.model().startValues[s]}o=Math.round(a*n.options.animationResolution)/n.options.animationResolution;break}if(s=="rotate"){i.style["-webkit-transform"]="rotate("+o+"deg)";i.style["-moz-transform"]="rotate("+o+"deg)";i.style["-ms-transform"]="rotate("+o+"deg)";i.style["-o-transform"]="rotate("+o+"deg)";i.style["transform"]="rotate("+o+"deg)"}else if(s=="opacity"){i.style["filter"]="alpha(opacity="+o*100+")";i.style["-moz-opacity"]=o;i.style["-khtml-opacity"]=o;i.style["opacity"]=o;i.style["-ms-filter"]="progid:DXImageTransform.Microsoft.Alpha(Opacity="+o*100+")";i.style["filter"]="progid:DXImageTransform.Microsoft.Alpha(Opacity="+o*100+")"}else{i.style[s]=o+"px"}}break}};var c=function(e,t){log("looking for "+e);if(typeof window[e]=="function"){window[e](t)}};a(e,t);n.animationElements;n.options;n.instructions=function(){return o};n.addElement=function(e){if(!(e instanceof animationElement)){return false}if(!n.animationElements){n.animationElements=[]}if(!n.animationElements[e.element()]){n.animationElements[e.element()]=new Array}n.animationElements[e.element()].push(e)};n.step=function(){f()};n.inputJSON=function(e){if(!e){return alert("must pass json to this function")}var t=e;for(i=0;i<t.length;i++){if(t[i]!=undefined&&t[i]!=null&&t[i].values!=null){var r=t[i].values;var s=new Object;var o=new Object;for(var u in r){s[u]=r[u].s;o[u]=r[u].e}var a=t[i].startend.s;var f=t[i].startend.e;var l=new animationElement(t[i].element,{startValues:s,endValues:o,unit:t[i].unit,animationStartPoint:a,animationEndPoint:f,easing:t[i].easing});n.addElement(l)}}};n.processStep=function(e){s=n.calculateCurrentStep();for(var t in n.animationElements){for(var r=0;r<n.animationElements[t].length;r++){var i=n.animationElements[t][r];var o=i.model().unit=="%"?i.model().animationStartPoint/100*n.options.totalSteps:i.model().animationStartPoint;var a=i.model().unit=="%"?i.model().animationEndPoint/100*n.options.totalSteps:i.model().animationEndPoint;var f=i.model().element.match(/^(\W)?(.*)/)[2];if(s>o&&s<a){if(i.model().inRange=="before"){c(f+r+"_Anim_Start",i.model().animationStartPoint)}else if(i.model().inRange=="after"){c(f+r+"_Anim_End",i.model().animationEndPoint)}i.model().inRange="during";l(i,(s-o)/(a-o))}else if(s<o&&i.model().inRange!="before"){i.model().inRange="before";c(f+r+"_Anim_Start",i.model().animationStartPoint);l(i,0)}else if(s>a&&i.model().inRange!="after"){i.model().inRange="after";c(f+r+"_Anim_End",i.model().animationEndPoint);l(i,1)}}}u=false;n.stepComplete()}};simpleAnimation.prototype.calculateCurrentStep=function(){return currentStep};simpleAnimation.prototype.stepComplete=function(){currentStep++};simpleAnimation.prototype.destroy=function(){this.animationElements=null};var animationElement=function(e,t,n){if(!e){return"must provide element"}var r=this;var i;var s;var o="these are the rules for using this Object";t=t?t:{};var u=function(t,n){var r={element:null,type:"css",unit:"px",inRange:"before",animationStartPoint:0,animationEndPoint:100,startValues:{},endValues:{},animationStepCallBack:{},easing:"none",currStep:0,storeInElement:false,animationCompleteCallBack:function(e){}};s=mergeObjects(r,t);if(n){s.scrollCompleteCallback=n}s.element=e;i=zest(s.element)};u(t,n);r.model=function(){return s};r.element=function(){return s.element};r.goToFrame=function(e){s.animationStepCallBack(e)}};var spriteAnimation=function(e,t){var n=this;var r;var i=1;var s=1;var o;var u;var a=function(e,t){var n={fps:12,cols:10,rows:2,stopAt:null,cell_width:250,cell_height:250,loop:false,stopAt:null,src:"images/sprite.png",spriteElement:"<div class='sprite _1'></div>",endFrame:null,loadingVisible:true,loadingElement:null,loadCallBack:null,autoplay:true,loadCallBack:function(e){},animationCompleteCallback:function(){}};u=mergeObjects(n,e);if(t){u.loadCallBack=t}r=u.spriteElement};var f=function(){log("animate",i);log(u.cell_width);var e=-((i-1)*u.cell_width);var t=-((s-1)*u.cell_height);var n=$$(r);n.style["backgroundPosition"]=e+"px "+t+"px";if(i<=u.cols){i++}else if(u.loop==true){i=1}else{if(u.endFrame!=null){n.style["background-position"]=u.cell_width+"px"}clearInterval(o)}if(u.stopAt&&i>=u.stopAt){clearInterval(o)}};a(e,t);this.model=function(){return u};this.instructions=function(){return instructions};this.image=function(){return u.src};this.start=function(){o=setInterval(function(){f()},parseInt(1e3/u.fps))};this.pause=function(){clearInterval(o)};this.reset=function(){i=1;var e=-((i-1)*u.cell_width);var t=-((s-1)*u.cell_height);var n=$$(r);n.style["background-position"]=e+"px "+t+"px"};this.element=function(){return r};this.changeRow=function(e){s=e};this.goToFrame=function(e){if(e<1){e=1}if(e>u.cols){e=u.cols}log("gotoframe",e);i=parseInt(e);f();return r};this.step=function(){if(u.cols>i+1){i++;f()}return r}};var imageSequenceAnimation=function(t,n){var r=this;var i;var s=0;var o=0;var u;var f;var l;var h;var p;var v=function(e,t){var n={fps:12,totalFrames:10,loop:false,srcBase:"images/sprite",ext:"jpg",sequenceElement:"<div class='sequence _1'></div>",endFrame:null,stopAt:null,loadingVisible:true,loadingElement:null,loadCallBack:null,autoplay:true,loadCallBack:function(e){},animationCompleteCallback:function(){}};r.options=mergeObjects(n,e);if(t){p.loadCallBack=t}i=r.options.sequenceElement;m()};var m=function(){var e=document.createElement("div");e.className="a";e.style.position="absolute";e.style.height="100%";e.style.width="100%";e.style.top=0;e.style.left=0;e.style.backgroundPosition="top center";var t=document.createElement("div");t.className="b";t.style.position="absolute";t.style.height="100%";t.style.width="100%";t.style.top=0;t.style.left=0;t.style.backgroundPosition="top center";var n=document.createElement("div");n.className="c";n.style.position="absolute";n.style.height="100%";n.style.width="100%";n.style.top=0;n.style.left=0;n.style.backgroundPosition="top center";var o=document.createElement("div");o.className="d";o.style.position="absolute";o.style.height="100%";o.style.width="100%";o.style.top=0;o.style.left=0;o.style.backgroundPosition="top center";var a=document.createElement("div");a.className="e";a.style.position="absolute";a.style.height="100%";a.style.width="100%";a.style.top=0;a.style.left=0;a.style.backgroundPosition="top center";$$(i).appendChild(t);$$(i).appendChild(n);$$(i).appendChild(o);$$(i).appendChild(a);$$(i).appendChild(e);u=$$(i+" .a");f=$$(i+" .b");Next_Next_Child=$$(i+" .d");l=$$(i+" .c");Previous_Previous_Child=$$(i+" .e");log(r);var c=s<r.options.totalFrames?s+1:r.options.totalFrames;var h=s+1<r.options.totalFrames?s+2:r.options.totalFrames;var p=s>0?s-1:0;var d=s-1>0?s-2:0;u.style["backgroundImage"]="url('"+r.options.srcBase+s+"."+r.options.ext+"')";f.style["backgroundImage"]="url('"+r.options.srcBase+c+"."+r.options.ext+"')";Next_Next_Child.style["backgroundImage"]="url('"+r.options.srcBase+h+"."+r.options.ext+"')";l.style["backgroundImage"]="url('"+r.options.srcBase+p+"."+r.options.ext+"')";Previous_Previous_Child.style["backgroundImage"]="url('"+r.options.srcBase+d+"."+r.options.ext+"')"};var g=function(t){a=u,b=f,c=l,d=Next_Next_Child,e=Previous_Previous_Child;if(s>o){u=b,l=a,f=d,Previous_Previous_Child=c,Next_Next_Child=e;l.style.display="none";f.style.display="none";Previous_Previous_Child.style.display="none";Next_Next_Child.style.display="none";u.style.display="block"}else{u=c,l=e,f=a,Previous_Previous_Child=d,Next_Next_Child=b;l.style.display="none";f.style.display="none";Previous_Previous_Child.style.display="none";Next_Next_Child.style.display="none";u.style.display="block"}if(!t){if(s<=r.options.totalFrames){o=s;s++}else if(p.loop==true){s=o=1}else{if(p.endFrame!=null){$$(i).style["background-position"]=p.cell_width+"px"}clearInterval(h)}if(r.options.stopAt&&s>=r.options.stopAt){clearInterval(h)}}var n=s<r.options.totalFrames?s+1:r.options.totalFrames;var v=s+1<r.options.totalFrames?s+2:r.options.totalFrames;var m=s>0?s-1:0;var g=s-1>0?s-2:0;f.style["backgroundImage"]="url('"+r.options.srcBase+n+"."+r.options.ext+"')";Next_Next_Child.style["backgroundImage"]="url('"+r.options.srcBase+v+"."+r.options.ext+"')";l.style["backgroundImage"]="url('"+r.options.srcBase+m+"."+r.options.ext+"')";Previous_Previous_Child.style["backgroundImage"]="url('"+r.options.srcBase+g+"."+r.options.ext+"')"};v(t,n);this.model=function(){return p};this.instructions=function(){return instructions};this.image=function(){return p.src};this.start=function(){h=setInterval(function(){g()},parseInt(1e3/r.options.fps))};this.pause=function(){clearInterval(h)};this.reset=function(){s=1;g()};this.element=function(){return i};this.changeRow=function(e){Current_Row=e};this.goToFrame=function(e){if(s!=parseInt(e)){s=parseInt(e);g(true)}return i};this.step=function(){if(p.cols>s+1){s++;g()}return i}};var sScrollAnimation=function(e,t){var n=this;var r="";e=e?e:{};var i=function(e,t){simpleAnimation.call(n);var i={context:window,autoEnable:false};n.options=mergeObjects(i,n.options);n.options=mergeObjects(n.options,e);if(t){n.options.animateCompleteCallback=t}n.options.instructions=r;if(n.options.autoEnable==true){n.bindScroll()}n.setStepValues()};n.bindScroll=function(){var e=this.options.context==window?window:zest(this.options.context).length?zest(this.options.context)[0]:zest(this.options.context);log(this.options.context);vine.unbind(e,"scroll",n.step);vine.bind(e,"scroll",n.step)};n.unBindScroll=function(){n.options.context.unbind("scroll",n.step)};i(e,t)};sScrollAnimation.prototype=new simpleAnimation;sScrollAnimation.prototype.constructor=sScrollAnimation;sScrollAnimation.prototype.setStepValues=function(){var e=this.options.context==window?"":this.options.context;var t=getHeight(e);var n=this.options.context==window?window.innerHeight:zest(this.options.context).length?zest(this.options.context)[0].offsetHeight:zest(this.options.context).offsetHeight;log(n);this.options.totalSteps=t-n};sScrollAnimation.prototype.calculateCurrentStep=function(){var e=this.options.context==window?"":this.options.context;var t=getScrollTop(e);return t};sScrollAnimation.prototype.stepComplete=function(){};var sTimerAnimation=function(e,t){var n=this;var r="";e=e?e:{};var i=function(e,t){simpleAnimation.call(n);var i={totalTime:1e4,autoStart:false,timerON:true};n.options=mergeObjects(i,n.options);n.options=mergeObjects(n.options,e);if(t){n.options.animateCompleteCallback=t}n.options.instructions=r;n.options.totalSteps=n.options.totalTime/16;if(n.options.autoStart==true){n.timerStart()}};n.currentStep=0;n.Timer=function(e){if(n.options.timerON!=false){window.requestAnimationFrame(n.Timer);n.processStep()}};n.timerStart=function(){n.options.timerON=true;window.requestAnimationFrame(n.Timer)};n.timerStop=function(){window.cancelAnimationFrame(n.Timer);n.options.timerON=false};n.timerReset=function(){n.currentStep=0;currentStep=n.options.firstStep};i(e,t)};sTimerAnimation.prototype=new simpleAnimation;sTimerAnimation.prototype.constructor=sTimerAnimation;sTimerAnimation.prototype.calculateCurrentStep=function(){return this.currentStep};sTimerAnimation.prototype.stepComplete=function(){if(this.currentStep<this.options.totalSteps){this.currentStep++}else{this.timerStop();this.timerReset()}};var sTouchMoveAnimation=function(e,t){function n(e){s.lastTouchY=e.changedTouches[0].screenY}function r(e){s.lastTouchY=-1}function i(e){e.preventDefault();s.touchmoveTop-=(e.changedTouches[0].screenY-s.lastTouchY)*s.options.multiplier;if(s.touchmoveTop<0){s.touchmoveTop=0}else if(s.touchmoveTop>s.options.maxTop){s.touchmoveTop=s.options.maxTop}s.lastTouchY=e.changedTouches[0].screenY;s.step();log(s.touchmoveTop);s.options.scrollStepCallBack(s.touchmoveTop)}var s=this;var o="";e=e?e:{};s.touchmoveTop=0;s.lastTouchY=-1;var u=function(e,t){simpleAnimation.call(s);var n={context:window,autoEnable:false,maxTop:1e4,multiplier:1,scrollStepCallBack:function(e){}};s.options=mergeObjects(n,s.options);s.options=mergeObjects(s.options,e);if(t){s.options.animateCompleteCallback=t}s.options.instructions=o;if(s.options.autoEnable==true){s.bindScroll()}};s.bindScroll=function(){s.options.context.removeEventListener("touchmove",i);s.options.context.addEventListener("touchmove",i);s.options.context.removeEventListener("touchstart",n);s.options.context.addEventListener("touchstart",n);s.options.context.removeEventListener("touchend",r);s.options.context.addEventListener("touchend",r)};s.unBindScroll=function(){s.options.context.removeEventListener("touchmove",i);s.options.context.removeEventListener("touchstart",n);s.options.context.removeEventListener("touchend",r)};s.maxTop=function(e){s.options.maxTop=e};s.touchStep=function(e){if(!e){return s.touchmoveTop}else{s.touchmoveTop=e;s.step()}};u(e,t)};sTouchMoveAnimation.prototype=new simpleAnimation;sTouchMoveAnimation.prototype.constructor=sTouchMoveAnimation;sTouchMoveAnimation.prototype.calculateCurrentStep=function(){var e=this.touchmoveTop;return e};sTouchMoveAnimation.prototype.stepComplete=function(){}